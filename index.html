<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Product Authentication</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <style>
      body{
        background: url('company.jpg');
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
        background-attachment: fixed;
    }
   
      .buttons{
        margin-left: 35%;
      }
    </style>
  </head>
  <body>
    <h1 style="text-align: center;">Product Authentication</h1>
    <br>
    <br>
    <div class="buttons">
      <button class="btn btn-primary" onclick="com_show()">Company</button>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button class="btn btn-primary" onclick="dis_show()" >Distributer</button>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button class="btn btn-primary" onclick="ret_show()">Retailer</button>
    </div>
  <hr>
    <div class="company">
      <div class="row">
        <div class="col-md-4"></div>
        <div class="col-md-4">
             <!--To add Company-->
      <div class="signup">
        <form id="addcomp">
          <h1>ADD COMPANY</h1>
          <small id="emailHelp" class="form-text text-muted">Kindly fill the following fields</small>
          <div class="form-group">
            <label for="exampleInputEmail1">Company Name</label>
            <input type="text" class="form-control" id="compName1" aria-describedby="textHelp" placeholder="Enter Company Name">
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1">Company ID</label>
            <input type="password" class="form-control" id="compID1" placeholder="Enter Company ID">
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1">Offial Email</label>
            <input type="email" class="form-control" id="c_email" placeholder="Enter Offial Email">
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1">Offial Phone No</label>
            <input type="text" class="form-control" id="c_phno" placeholder="Enter Offial Phone No">
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1">Company Location</label>
            <input type="text" class="form-control" id="c_location" placeholder="Enter Company Location">
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1">Company Adress</label>
            <textarea type="text" class="form-control" id="c_adress" placeholder="Enter Company Adress">
              </textarea>
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1">registeration ID</label>
            <input type="password" class="form-control" id="c_registration_id" placeholder="Enter registeration ID">
          </div>
      
          <button type="button" class="btn btn-primary" onclick="Addcompany()" >Add Company</button>
        </form>
      </div>
      <!--To Login Company-->
      <div class="login">
        <form id="displayComp" >
          <h3>VERIFY YOURSELF</h3>
          <small id="emailHelp" class="form-text text-muted">Kindly Verify Yourself</small>
          <div class="form-group">
            <label for="exampleInputPassword1">Company ID</label>
            <input type="password" class="form-control" id="compID2" placeholder="Enter Company ID">
          </div>
          <button type="button" class="btn btn-primary" onclick="verify();">Verify</button>
        </form>
        <br>
        <small>If you not registered company with Product Authentication</small>
        <button type="button" class="btn btn-primary" onclick="signup();">Add Company</button>
        <span style="color: red;" id="msg"></span>
      </div>
      
      <div class="add-product">
        <form id="addProduct" >
          <h1>ADD PRODUCT DETAILS</h1>
          <small id="emailHelp" class="form-text text-muted">Kindly fill the following fields</small>
          <div class="form-group">
            <label for="exampleInputEmail1">Product Name</label>
            <input type="text" class="form-control" id="prodName3" aria-describedby="textHelp" placeholder="Enter Product Name">
          </div>
          <div class="form-group">
            <label for="exampleInputEmail1">Product ID</label>
            <input type="text" class="form-control" id="p_id" aria-describedby="textHelp" placeholder="Enter Product ID">
          </div>
          <div class="form-group">
            <label for="exampleInputPassword1">Company ID</label>
            <input type="password" class="form-control" id="compID3" placeholder="Enter Company ID">
          </div>
          <div class="form-group">
            <label for="exampleInputEmail1">Product Descrption</label>
            <input type="text" class="form-control" id="p_desc" aria-describedby="textHelp" placeholder="Enter Product Description">
          </div>
          <div class="form-group">
            <label for="exampleInputEmail1">Product MRP(Price)</label>
            <input type="text" class="form-control" id="mrp" aria-describedby="textHelp" placeholder="Enter MRP of Producr">
          </div>
          <button type="button" class="btn btn-primary" onclick="addproduct()">Add Product</button>
        </form>
      </div>
    </div>
  
    <!-- <div class="v-product ">
      <h1>VERIFICATION PORTAL</h1>
            <small id="emailHelp" class="form-text text-muted">Verify Your Product Here</small>
            <div class="form-group">
              <label for="exampleInputPassword1">Kindly Enter the Product ID</label>
              <input type="number" class="form-control" id="retID12" placeholder="Enter Product ID">
            </div>
            <button type="button" class="btn btn-outline-warning" onclick="App.verificationPortal()">Verify!</button>
          </form>
      </div>
    </div> -->
      <div class="col">
        <p id="message"></p>
      </div>
    </div>
</div>




















<div class="distributer">
 <div class="row">
  <div class="col-md-4"></div>
  <div class="col-md-4">
    <div class="dis-login">
    <form id="displayComp" >
      <h3>VERIFY YOURSELF</h3>
      <small id="emailHelp" class="form-text text-muted">Kindly Verify Yourself</small>
      <div class="form-group">
        <label for="exampleInputPassword1">Distributer ID</label>
        <input type="password" class="form-control" id="dis_id" placeholder="Enter Distributer ID">
      </div>
      <button type="button" class="btn btn-primary" onclick="dis_verify();">Verify</button>
    </form>
    <br>
    <small style="font-weight: 900;color: red;">If you don't have account in Product Authentication</small>
    <button type="button" class="btn btn-primary" onclick="dis_signup();">Don't have Account?</button>
    <span style="color: red;" id="dmsg"></span>
  </div>
  <div class="dis-signup">
    <form id="addcomp">
      <h1>SIGN UP DISTRIBUTER</h1>
      <small id="emailHelp" class="form-text text-muted">Kindly fill the following fields</small>
      <div class="form-group">
        <label for="exampleInputEmail1">Distributer Name</label>
        <input type="text" class="form-control" id="d_name" aria-describedby="textHelp" placeholder="Enter Distributer  Name">
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Distributer  ID</label>
        <input type="password" class="form-control" id="d_id" placeholder="Enter Distributer ID">
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Offial Email</label>
        <input type="email" class="form-control" id="d_email" placeholder="Enter Offial Email">
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Offial Phone No</label>
        <input type="text" class="form-control" id="d_phno" placeholder="Enter Offial Phone No">
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Distributer  Location</label>
        <input type="text" class="form-control" id="d_location" placeholder="Enter Distributer  Location">
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Distributer  Address</label>
        <textarea type="text" class="form-control" id="d_adress" placeholder="Enter Distributer Address">
          </textarea>
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Company ID</label>
        <input type="password" class="form-control" id="d_c_id" placeholder="Enter Company ID">
      </div>
  
      <button type="button" class="btn btn-primary" onclick="AddDistributer()" >Sigup</button>
    </form>
  </div>
  <div class="d_p_auth">
     <div id="d-camera">

     </div>
     <div class="register">
       <p>Product Authenticated successfully...</p>
      <button class="btn btn-primary" onclick="d_register()">Done</button>
     </div>
  </div>
  </div>
  
 </div>
</div>
















<div class="retailer">
  <div class="row">
    <div class="col-md-4"></div>
    <div class="col-md-4">
      <div class="ret-login">
      <form id="displayComp" >
        <h3>VERIFY YOURSELF</h3>
        <small id="emailHelp" class="form-text text-muted">Kindly Verify Yourself</small>
        <div class="form-group">
          <label for="exampleInputPassword1">Retailer ID</label>
          <input type="password" class="form-control" id="ret_id" placeholder="Enter Retailer ID">
        </div>
        <button type="button" class="btn btn-primary" onclick="ret_verify();">Verify</button>
      </form>
      <br>
      <small style="font-weight: 900;color: red;">If you don't have account in Product Authentication</small>
      <button type="button" class="btn btn-primary" onclick="ret_signup();">Don't have Account?</button>
      <span style="color: red;" id="rmsg"></span>
    </div>
    <div class="ret-signup">
      <form id="addcomp">
        <h1>SIGN UP RETAILER</h1>
        <small id="emailHelp" class="form-text text-muted">Kindly fill the following fields</small>
        <div class="form-group">
          <label for="exampleInputEmail1">Retailer Name</label>
          <input type="text" class="form-control" id="r_name" aria-describedby="textHelp" placeholder="Enter Retailer  Name">
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Retailer  ID</label>
          <input type="password" class="form-control" id="r_id" placeholder="Enter Retailer ID">
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Offial Email</label>
          <input type="email" class="form-control" id="r_email" placeholder="Enter Offial Email">
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Offial Phone No</label>
          <input type="text" class="form-control" id="r_phno" placeholder="Enter Offial Phone No">
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Retailer Location</label>
          <input type="text" class="form-control" id="r_location" placeholder="Enter Retailer Location">
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Retailer Address</label>
          <textarea type="text" class="form-control" id="r_address" placeholder="Enter Retailer Address">
            </textarea>
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Company ID</label>
          <input type="password" class="form-control" id="r_c_id" placeholder="Enter Company ID">
        </div>
    
        <button type="button" class="btn btn-primary" onclick="AddRetailer()" >Sigup</button>
      </form>
    </div>
    <div class="r_p_auth">
       <div id="r-camera">
  
       </div>
       <div class="r_register">
         <p>Product Authenticated successfully...</p>
        <button class="btn btn-primary" onclick="r_register()">Done</button>
       </div>
    </div>
    </div>
    
   </div>
</div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="quagga.min.js"></script>
    <script src="js/web3.min.js"></script>
    <script src="js/truffle-contract.js"></script>
    <script src="js/app.js"></script>
    <script>
      window.onload=function(){
        $('.company').hide();
        $('.retailer').hide();
        $('.distributer').hide(); 
      }
      function com_show(){
        $('.company').show();
        $('.retailer').hide();
        $('.distributer').hide();
        $('.login').show();
        $('.signup').hide();
        $('.add-product').hide();
      }
      function signup(){
        $('.login').hide();
        $('.signup').show();
      }
      function dis_show(){
        $('.company').hide();
        $('.retailer').hide();
        $('.distributer').show();
        $('.dis-login').show();
        $('.dis-signup').hide();
        $('.d_p_auth').hide();
      }
      function ret_show(){
        $('.company').hide();
        $('.retailer').show();
        $('.distributer').hide();
        $('.ret-login').show();
        $('.ret-signup').hide();
        $('.r_p_auth').hide();
      }
      function Addcompany(){
        var status=App.addCompany()
        var status=true;
        if(status==true){
          var c_name=document.getElementById('compName1').value;
          var c_id=document.getElementById('compID1').value;
          var c_email=document.getElementById('c_email').value;
          var c_phno=document.getElementById('c_phno').value;
          var c_location=document.getElementById('c_location').value;
          var c_address=document.getElementById('c_address').value;
          var c_r_no=document.getElementById('c_registration_id').value;
          var xhr=new XMLHttpRequest()
          let url=`http://127.0.0.1:3000/addcompany/${d_name}/${c_id}/${c_email}/${c_phno}/${c_location}/${c_address}`
          xhr.open('GET',url)
          xhr.onload=(res)=>{
             console.log(res.currentTarget.responseText)
          }
          xhr.send();
        }
        $('.signup').hide();
        $('.login').show();

      }
      function verify(){
      var status=App.verifyComp();
      if(status==true){
        $('.login').hide();
        $('.add-product').show();
      }
      else{
        document.getElementById('msg').innerHTML="Invalid company ID"
      }     
      }
      function dis_signup(){
        $('.dis-login').hide();
        $('.dis-signup').show();
      }
      function ret_signup(){
        $('.ret-login').hide();
        $('.ret-signup').show();
      }
    function AddRetailer(){
          var r_name=document.getElementById('r_name').value;
          var r_id=document.getElementById('r_id').value;
          var r_email=document.getElementById('r_email').value;
          var r_phno=document.getElementById('r_phno').value;
          var r_location=document.getElementById('r_location').value;
          var r_address=document.getElementById('r_address').value;
          var r_c_id=document.getElementById('r_c_id').value;
          var xhr=new XMLHttpRequest()
          let url=`http://127.0.0.1:3000/add_ret/${r_name}/${r_id}/${r_c_id}/${r_email}/${r_phno}/${r_location}/${r_address}`
          xhr.open('GET',url)
          xhr.onload=(res)=>{
             console.log(res.currentTarget.responseText)
          }
          xhr.send();
      $('.ret-signup').hide(); 
      $('.ret-login').show();   
    }
    var product_id; 
    function dis_verify(){
      var dis_id=document.getElementById('dis_id').value;
      var xhr=new XMLHttpRequest()
      let url=`http://127.0.0.1:3000/dis_very/${dis_id}`
      xhr.open('GET',url)
      xhr.onload=(res)=>{
        let varified=JSON.parse(res.currentTarget.responseText)
        if(varified.status){
          $('.dis-login').hide();
          $('.d_p_auth').show();
          $('.register').hide();
          //open barcode scanner
          Quagga.init({
            inputStream : {
              name : "Live",
              type : "LiveStream",
              target: document.querySelector('#d-camera')    // Or '#yourElement' (optional)
          },
          debug: {
            drawBoundingBox: true,
            showFrequency: true,
            drawScanline: true,
            showPattern: true
          },
            decoder : {
              readers : ["code_128_reader"]
            }
          }, function(err) {
              if (err) {
                  console.log(err);
                  return
              }
              console.log("Initialization finished. Ready to start");
              Quagga.start();
          });
           Quagga.onDetected(function(data){
            //verify_product(data.codeResult.code);
            var p_id=data.codeResult.code;
            var xhr=new XMLHttpRequest()
            let url=`http://127.0.0.1:3000/dis_verified/${p_id}`
            xhr.open('GET',url)
             xhr.onload=()=>{
                alert("registerd succussfully.....")
              }
      xhr.send();
            $('.d_p_auth').hide()
            $('.register').show();
           });
        }
        else{
          document.getElementById('dmsg').innerHTML="Invalid distributer Id"
        }
      }
      xhr.send();
      

    }
    function ret_verify(){
      var ret_id=document.getElementById('ret_id').value;
      var xhr=new XMLHttpRequest()
      let url=`http://127.0.0.1:3000/ret_very/${ret_id}`
      xhr.open('GET',url)
      xhr.onload=(res)=>{
        let varified=JSON.parse(res.currentTarget.responseText)
        if(varified.status){
          $('.ret-login').hide();
          $('.r_p_auth').show();
          $('.r_register').hide();
          //open barcode scanner
          Quagga.init({
            inputStream : {
              name : "Live",
              type : "LiveStream",
              target: document.querySelector('#r-camera')    // Or '#yourElement' (optional)
          },
          debug: {
            drawBoundingBox: true,
            showFrequency: true,
            drawScanline: true,
            showPattern: true
          },
            decoder : {
              readers : ["code_128_reader"]
            }
          }, function(err) {
              if (err) {
                  console.log(err);
                  return
              }
              console.log("Initialization finished. Ready to start");
              Quagga.start();
          });
           Quagga.onDetected(function(data){
            //verify_product(data.codeResult.code);
            var p_id=data.codeResult.code;
            var xhr=new XMLHttpRequest()
            let url=`http://127.0.0.1:3000/ret_verified/${p_id}`
            xhr.open('GET',url)
            xhr.onload=()=>{
              alert("registerd succussfully.....")
            }
            xhr.send();
            $('.r_p_auth').hide()
            $('.r_register').show();
           });
        }
        else{
          document.getElementById('rmsg').innerHTML="Invalid retailer Id"
        }
      }
      xhr.send();
      

    }
    function d_register(){
      $('.register').hide();
      $('.d_p_auth').show();
    }
    function r_register(){
      $('.r_register').hide();
      $('.r_p_auth').show();

    }
    </script>
  </body>
</html>
